<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Luxury Raya Scratch & Win</title>
<link href="https://fonts.googleapis.com/css2?family=Amiri&display=swap" rel="stylesheet">
<style>
body {
  margin: 0;
  padding: 0;
  font-family: 'Amiri', serif;
  background: radial-gradient(circle at top, #134e3a, #0f3d2e);
  color: gold;
  text-align: center;
}

.container {
  max-width: 380px;
  margin: 50px auto;
  background: rgba(19,78,58,0.95);
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 0 30px rgba(255,215,0,0.7);
}

.hidden { display: none; }

h1 {
  font-size: 26px;
  text-shadow: 0 0 10px gold;
}

button {
  background: gold;
  border: none;
  padding: 12px 25px;
  font-size: 16px;
  border-radius: 10px;
  cursor: pointer;
  color: #0f3d2e;
}

.boxes {
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
}

canvas {
  width: 100px;
  height: 100px;
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(255,215,0,0.8);
  cursor: pointer;
}

canvas.disabled {
  opacity: 0.5;
  pointer-events: none;
}
</style>
</head>

<body>

<div class="container" id="startScreen">
  <h1>âœ¨ Selamat Hari Raya âœ¨</h1>
  <p>Scratch ONE box to win Duit Raya ğŸ‰</p>
  <button onclick="startGame()">Start</button>
</div>

<div class="container hidden" id="gameScreen">
  <h1>Scratch One ğŸ</h1>
  <div class="boxes">
    <canvas id="box0" width="100" height="100"></canvas>
    <canvas id="box1" width="100" height="100"></canvas>
    <canvas id="box2" width="100" height="100"></canvas>
  </div>
</div>

<div class="container hidden" id="resultScreen">
  <h1>ğŸ‰ Tahniah! ğŸ‰</h1>
  <p id="prizeText"></p>
  <p>Please show this screen to the host to receive your duit raya.</p>
  <button onclick="restart()">Play Again</button>
</div>

<script>
const prizes = ["$2", "$4", "$6"];
let shuffled = [];
let finished = false;

function startGame() {
  shuffled = prizes.sort(() => 0.5 - Math.random());
  finished = false;
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("gameScreen").classList.remove("hidden");

  for (let i = 0; i < 3; i++) {
    initScratch(i, shuffled[i]);
  }
}

function initScratch(index, prize) {
  const canvas = document.getElementById("box" + index);
  const ctx = canvas.getContext("2d");

  // Prize under layer
  ctx.fillStyle = "#0f3d2e";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = "gold";
  ctx.font = "bold 22px Amiri";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText(prize, canvas.width / 2, canvas.height / 2);

  // Gold scratch layer
  const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
  gradient.addColorStop(0, "#ffd700");
  gradient.addColorStop(0.5, "#e6c200");
  gradient.addColorStop(1, "#ffd700");
  ctx.fillStyle = gradient;
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  canvas.onmousedown = canvas.ontouchmove = function(e) {
    if (finished) return;
    e.preventDefault();

    const rect = canvas.getBoundingClientRect();
    const x = (e.clientX || e.touches[0].clientX) - rect.left;
    const y = (e.clientY || e.touches[0].clientY) - rect.top;

    ctx.globalCompositeOperation = "destination-out";
    ctx.beginPath();
    ctx.arc(x, y, 14, 0, Math.PI * 2);
    ctx.fill();

    const data = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
    let cleared = 0;
    for (let i = 3; i < data.length; i += 4) {
      if (data[i] < 128) cleared++;
    }

    if (cleared > data.length * 0.35) {
      finishGame(prize);
    }
  };
}

function finishGame(prize) {
  finished = true;
  document.querySelectorAll("canvas").forEach(c => c.classList.add("disabled"));
  document.getElementById("gameScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");
  document.getElementById("prizeText").innerText =
    `You won ${prize} Duit Raya ğŸ’š`;
}

function restart() {
  document.getElementById("resultScreen").classList.add("hidden");
  document.getElementById("startScreen").classList.remove("hidden");
}
</script>

</body>
</html>
